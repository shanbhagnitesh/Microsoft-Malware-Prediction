library(readr)
install.packages("dplyr")
library(dplyr)
library(lubridate)
library(caret)

# Read the training data
setwd("C:/Users/nshanbhag/Desktop/BigDataAnalytics/Machine learning for Marketing/Group Project")
library(readxl)
data <- read_csv("train.csv")


## set the seed to make your partition reproducible
set.seed(123)

train_ind <- sample(seq_len(nrow(data)), size = 80000)
train <- data[train_ind, ]
test <- data[-train_ind, ]
data <- NULL

test1 = sample(1:length(test), 20000, replace=T)
test = test %>% slice(test1)


##############################################################################################
nms <- colnames(train)
train[nms] <- lapply(train[nms], as.character) 
train$HasDetections <- as.numeric(train$HasDetections)


install.packages("Information")
library(Information)
#Information package author is Kim Larsen

IV <- create_infotables(data=train, y='HasDetections', parallel = FALSE)
IV$Tables


##############################################################################################

# Cleaning Starts here
##############################################################################################

# 2.ProductName

unique(train$ProductName)
sum(is.na(train$ProductName))
train = merge(x = train, y = IV$Tables$ProductName[ , c("ProductName", "WOE")], by = "ProductName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'ProductNameWOE'
sum(is.na(train$ProductNameWOE))
unique(train$ProductNameWOE)

test = merge(x = test, y = IV$Tables$ProductName[ , c("ProductName", "WOE")], by = "ProductName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'ProductNameWOE'
sum(is.na(test$ProductNameWOE))

train$ProductName <- NULL 
test$ProductName <- NULL

##############################################################################################

# EngineVersion


table(train$EngineVersion)

train = merge(x = train, y = IV$Tables$EngineVersion[ , c("EngineVersion", "WOE")], by = "EngineVersion", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'EngineVersionWOE'
sum(is.na(train$EngineVersionWOE))

test = merge(x = test, y = IV$Tables$EngineVersion[ , c("EngineVersion", "WOE")], by = "EngineVersion", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'EngineVersionWOE'
sum(is.na(test$EngineVersionWOE))


train$EngineVersion <- NULL 
test$EngineVersion <- NULL
##############################################################################################


# AppVersion

table(train$AppVersion)

train = merge(x = train, y = IV$Tables$AppVersion[ , c("AppVersion", "WOE")], by = "AppVersion", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'AppVersionWOE'
sum(is.na(train$AppVersionWOE))

test = merge(x = test, y = IV$Tables$AppVersion[ , c("AppVersion", "WOE")], by = "AppVersion", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'AppVersionWOE'
sum(is.na(test$AppVersionWOE))



train$AppVersion <- NULL 
test$AppVersion <- NULL
##############################################################################################

# AvSigVersion too many unique values

train$AvSigVersion <- NULL
test$AvSigVersion <- NULL
##############################################################################################


# AppVersion
train$IsBeta <- NULL
test$IsBeta <- NULL

##############################################################################################

table(train$RtpStateBitfield)

train = merge(x = train, y = IV$Tables$RtpStateBitfield[ , c("RtpStateBitfield", "WOE")], by = "RtpStateBitfield", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'RtpStateBitfieldWOE'
sum(is.na(train$RtpStateBitfieldWOE))


test = merge(x = test, y = IV$Tables$RtpStateBitfield[ , c("RtpStateBitfield", "WOE")], by = "RtpStateBitfield", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'RtpStateBitfieldWOE'
sum(is.na(test$RtpStateBitfieldWOE))


train$RtpStateBitfield <- NULL 
test$RtpStateBitfield <- NULL
##############################################################################################

train$IsSxsPassiveMode <- NULL
test$IsSxsPassiveMode <- NULL

##############################################################################################
table(train$DefaultBrowsersIdentifier)

train = merge(x = train, y = IV$Tables$DefaultBrowsersIdentifier[ , c("DefaultBrowsersIdentifier", "WOE")], by = "DefaultBrowsersIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'DefaultBrowsersIdentifierWOE'
sum(is.na(train$DefaultBrowsersIdentifierWOE))


test = merge(x = test, y = IV$Tables$DefaultBrowsersIdentifier[ , c("DefaultBrowsersIdentifier", "WOE")], by = "DefaultBrowsersIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'DefaultBrowsersIdentifierWOE'
sum(is.na(test$DefaultBrowsersIdentifierWOE))

train$DefaultBrowsersIdentifier <- NULL 
test$DefaultBrowsersIdentifier <- NULL

##############################################################################################
train$AVProductStatesIdentifier <- NULL
test$AVProductStatesIdentifier <- NULL

##############################################################################################
table(train$AVProductsInstalled)

train = merge(x = train, y = IV$Tables$AVProductsInstalled[ , c("AVProductsInstalled", "WOE")], by = "AVProductsInstalled", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'AVProductsInstalledWOE'
sum(is.na(train$AVProductsInstalledWOE))


test = merge(x = test, y = IV$Tables$AVProductsInstalled[ , c("AVProductsInstalled", "WOE")], by = "AVProductsInstalled", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'AVProductsInstalledWOE'
sum(is.na(test$AVProductsInstalledWOE))

train$AVProductsInstalled <- NULL 
test$AVProductsInstalled <- NULL

##############################################################################################
table(train$AVProductsEnabled)

train = merge(x = train, y = IV$Tables$AVProductsEnabled[ , c("AVProductsEnabled", "WOE")], by = "AVProductsEnabled", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'AVProductsEnabledWOE'
sum(is.na(train$AVProductsEnabledWOE))


test = merge(x = test, y = IV$Tables$AVProductsEnabled[ , c("AVProductsEnabled", "WOE")], by = "AVProductsEnabled", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'AVProductsEnabledWOE'
sum(is.na(test$AVProductsEnabledWOE))

train$AVProductsEnabled <- NULL 
test$AVProductsEnabled <- NULL

##############################################################################################

train$HasTpm <- NULL
test$HasTpm <- NULL

##############################################################################################

table(train$CountryIdentifier)
sum(is.na(test$CountryIdentifier))

train = merge(x = train, y = IV$Tables$CountryIdentifier[ , c("CountryIdentifier", "WOE")], by = "CountryIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'CountryIdentifierWOE'
sum(is.na(train$CountryIdentifierWOE))


test = merge(x = test, y = IV$Tables$CountryIdentifier[ , c("CountryIdentifier", "WOE")], by = "CountryIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'CountryIdentifierWOE'
sum(is.na(test$CountryIdentifierWOE))

train$CountryIdentifier <- NULL
test$CountryIdentifier <- NULL
colnames(test)
##############################################################################################


table(train$CityIdentifier)
length(unique(train$CityIdentifier))


train$CityIdentifier <- NULL
test$CityIdentifier <- NULL


##############################################################################################



table(train$OrganizationIdentifier)
sum(is.na(train$OrganizationIdentifier))

train = merge(x = train, y = IV$Tables$OrganizationIdentifier[ , c("OrganizationIdentifier", "WOE")], by = "OrganizationIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OrganizationIdentifierWOE'
sum(is.na(train$OrganizationIdentifierWOE))


test = merge(x = test, y = IV$Tables$OrganizationIdentifier[ , c("OrganizationIdentifier", "WOE")], by = "OrganizationIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OrganizationIdentifierWOE'
sum(is.na(test$OrganizationIdentifierWOE))


train$OrganizationIdentifier <- NULL
test$OrganizationIdentifier <- NULL


##############################################################################################

table(train$GeoNameIdentifier)
sum(is.na(train$GeoNameIdentifier))

train = merge(x = train, y = IV$Tables$GeoNameIdentifier[ , c("GeoNameIdentifier", "WOE")], by = "GeoNameIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'GeoNameIdentifierWOE'
sum(is.na(train$GeoNameIdentifierWOE))


test = merge(x = test, y = IV$Tables$GeoNameIdentifier[ , c("GeoNameIdentifier", "WOE")], by = "GeoNameIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'GeoNameIdentifierWOE'
sum(is.na(test$GeoNameIdentifierWOE))

train$GeoNameIdentifier <- NULL
test$GeoNameIdentifier <- NULL



##############################################################################################

table(train$LocaleEnglishNameIdentifier)
sum(is.na(train$LocaleEnglishNameIdentifier))

train = merge(x = train, y = IV$Tables$LocaleEnglishNameIdentifier[ , c("LocaleEnglishNameIdentifier", "WOE")],
              by = "LocaleEnglishNameIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'LocaleEnglishNameIdentifierWOE'
sum(is.na(train$LocaleEnglishNameIdentifierWOE))


test = merge(x = test, y = IV$Tables$LocaleEnglishNameIdentifier[ , c("LocaleEnglishNameIdentifier", "WOE")],
              by = "LocaleEnglishNameIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'LocaleEnglishNameIdentifierWOE'
sum(is.na(test$LocaleEnglishNameIdentifierWOE))

train$LocaleEnglishNameIdentifier <- NULL
test$LocaleEnglishNameIdentifier <- NULL


##############################################################################################
table(train$Platform)
sum(is.na(train$Platform))

train = merge(x = train, y = IV$Tables$Platform[ , c("Platform", "WOE")],
              by = "Platform", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'PlatformWOE'
sum(is.na(train$PlatformWOE))


test = merge(x = test, y = IV$Tables$Platform[ , c("Platform", "WOE")],
              by = "Platform", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'PlatformWOE'
sum(is.na(test$PlatformWOE))


train$Platform <- NULL
test$Platform <- NULL


##############################################################################################
table(train$Processor)
sum(is.na(train$Processor))

train = merge(x = train, y = IV$Tables$Processor[ , c("Processor", "WOE")],
              by = "Processor", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'ProcessorWOE'
sum(is.na(train$ProcessorWOE))


test = merge(x = test, y = IV$Tables$Processor[ , c("Processor", "WOE")],
              by = "Processor", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'ProcessorWOE'
sum(is.na(test$ProcessorWOE))


train$Processor <- NULL
test$Processor <- NULL
##############################################################################################
table(train$OsVer)
sum(is.na(train$OsVer))

train = merge(x = train, y = IV$Tables$OsVer[ , c("OsVer", "WOE")],
              by = "OsVer", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OsVerWOE'
sum(is.na(train$OsVerWOE))


test = merge(x = test, y = IV$Tables$OsVer[ , c("OsVer", "WOE")],
              by = "OsVer", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OsVerWOE'
sum(is.na(test$OsVerWOE))

train$OsVer <- NULL
test$OsVer <- NULL
##############################################################################################



table(train$OsBuild)
sum(is.na(train$OsBuild))

train = merge(x = train, y = IV$Tables$OsBuild[ , c("OsBuild", "WOE")],
              by = "OsBuild", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OsBuildWOE'
sum(is.na(train$OsBuildWOE))


test = merge(x = test, y = IV$Tables$OsBuild[ , c("OsBuild", "WOE")],
              by = "OsBuild", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OsBuildWOE'
sum(is.na(test$OsBuildWOE))

train$OsBuild <- NULL
test$OsBuild <- NULL

##############################################################################################



table(train$OsSuite)
sum(is.na(train$OsSuite))

train = merge(x = train, y = IV$Tables$OsSuite[ , c("OsSuite", "WOE")],
              by = "OsSuite", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OsSuiteWOE'
sum(is.na(train$OsSuiteWOE))


test = merge(x = test, y = IV$Tables$OsSuite[ , c("OsSuite", "WOE")],
              by = "OsSuite", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OsSuiteWOE'
sum(is.na(test$OsSuiteWOE))


train$OsSuite <- NULL
test$OsSuite <- NULL


##############################################################################################



table(train$OsPlatformSubRelease)
sum(is.na(train$OsPlatformSubRelease))

train = merge(x = train, y = IV$Tables$OsPlatformSubRelease[ , c("OsPlatformSubRelease", "WOE")],
              by = "OsPlatformSubRelease", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OsPlatformSubReleaseWOE'
sum(is.na(train$OsPlatformSubReleaseWOE))


test = merge(x = test, y = IV$Tables$OsPlatformSubRelease[ , c("OsPlatformSubRelease", "WOE")],
              by = "OsPlatformSubRelease", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OsPlatformSubReleaseWOE'
sum(is.na(test$OsPlatformSubReleaseWOE))


train$OsPlatformSubRelease <- NULL
test$OsPlatformSubRelease<- NULL


##############################################################################################

table(train$OsBuildLab)
sum(is.na(train$OsBuildLab))

train = merge(x = train, y = IV$Tables$OsBuildLab[ , c("OsBuildLab", "WOE")],
              by = "OsBuildLab", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'OsBuildLabWOE'
sum(is.na(train$OsBuildLabWOE))


test = merge(x = test, y = IV$Tables$OsBuildLab[ , c("OsBuildLab", "WOE")],
              by = "OsBuildLab", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'OsBuildLabWOE'
sum(is.na(test$OsBuildLabWOE))
test$OsBuildLabWOE <- ifelse(is.na(test$OsBuildLabWOE) == TRUE,0, test$OsBuildLabWOE)

train$OsBuildLab <- NULL
test$OsBuildLab<- NULL

##############################################################################################

table(train$SkuEdition)
sum(is.na(train$SkuEdition))

train = merge(x = train, y = IV$Tables$SkuEdition[ , c("SkuEdition", "WOE")],
              by = "SkuEdition", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'SkuEditionWOE'
sum(is.na(train$SkuEditionWOE))


test = merge(x = test, y = IV$Tables$SkuEdition[ , c("SkuEdition", "WOE")],
              by = "SkuEdition", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'SkuEditionWOE'
sum(is.na(test$SkuEditionWOE))


train$SkuEdition <- NULL
test$SkuEdition<- NULL

##############################################################################################



train$IsProtected <- NULL
test$IsProtected<- NULL

##############################################################################################





train$AutoSampleOptIn <- NULL
test$AutoSampleOptIn<- NULL

##############################################################################################
##############################################################################################



train$PuaMode <- NULL
test$PuaMode<- NULL
##############################################################################################


train$SMode <- NULL
test$SMode<- NULL

##############################################################################################
table(train$IeVerIdentifier)
sum(is.na(train$IeVerIdentifier))

train = merge(x = train, y = IV$Tables$IeVerIdentifier[ , c("IeVerIdentifier", "WOE")],
              by = "IeVerIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'IeVerIdentifierWOE'
sum(is.na(train$IeVerIdentifierWOE))


test = merge(x = test, y = IV$Tables$IeVerIdentifier[ , c("IeVerIdentifier", "WOE")],
              by = "IeVerIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'IeVerIdentifierWOE'
sum(is.na(test$IeVerIdentifierWOE))

train$IeVerIdentifier <- NULL
test$IeVerIdentifier<- NULL


##############################################################################################
table(train$SmartScreen)
sum(is.na(train$SmartScreen))

train = merge(x = train, y = IV$Tables$SmartScreen[ , c("SmartScreen", "WOE")],
              by = "SmartScreen", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'SmartScreenWOE'
sum(is.na(train$SmartScreenWOE))

test = merge(x = test, y = IV$Tables$SmartScreen[ , c("SmartScreen", "WOE")],
              by = "SmartScreen", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'SmartScreenWOE'
sum(is.na(test$SmartScreenWOE))



train$SmartScreen <- NULL
test$SmartScreen<- NULL


##############################################################################################
table(train$Firewall)
sum(is.na(train$Firewall))

train$Firewall <- NULL
test$Firewall<- NULL

##############################################################################################

table(train$UacLuaenable)
sum(is.na(train$UacLuaenable))

train = merge(x = train, y = IV$Tables$UacLuaenable[ , c("UacLuaenable", "WOE")],
              by = "UacLuaenable", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'UacLuaenableWOE'
sum(is.na(train$UacLuaenableWOE))


test = merge(x = test, y = IV$Tables$UacLuaenable[ , c("UacLuaenable", "WOE")],
              by = "UacLuaenable", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'UacLuaenableWOE'
sum(is.na(test$UacLuaenableWOE))

train$UacLuaenable <- NULL
test$UacLuaenable <- NULL

##############################################################################################

table(train$Census_MDC2FormFactor)
sum(is.na(train$Census_MDC2FormFactor))

train = merge(x = train, y = IV$Tables$Census_MDC2FormFactor[ , c("Census_MDC2FormFactor", "WOE")],
              by = "Census_MDC2FormFactor", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_MDC2FormFactorWOE'
sum(is.na(train$Census_MDC2FormFactorWOE))


test = merge(x = test, y = IV$Tables$Census_MDC2FormFactor[ , c("Census_MDC2FormFactor", "WOE")],
              by = "Census_MDC2FormFactor", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_MDC2FormFactorWOE'
sum(is.na(test$Census_MDC2FormFactorWOE))


train$Census_MDC2FormFactor <- NULL
test$Census_MDC2FormFactor <- NULL

##############################################################################################



train$Census_DeviceFamily <- NULL
test$Census_DeviceFamily <- NULL



##############################################################################################

table(train$Census_OEMNameIdentifier)
sum(is.na(train$Census_OEMNameIdentifier))

train = merge(x = train, y = IV$Tables$Census_OEMNameIdentifier[ , c("Census_OEMNameIdentifier", "WOE")],
              by = "Census_OEMNameIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OEMNameIdentifierWOE'
sum(is.na(train$Census_OEMNameIdentifierWOE))


test = merge(x = test, y = IV$Tables$Census_OEMNameIdentifier[ , c("Census_OEMNameIdentifier", "WOE")],
              by = "Census_OEMNameIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OEMNameIdentifierWOE'
sum(is.na(test$Census_OEMNameIdentifierWOE))
test$Census_OEMNameIdentifierWOE <- ifelse(is.na(test$Census_OEMNameIdentifierWOE) == TRUE, 0,test$Census_OEMNameIdentifierWOE)


train$Census_OEMNameIdentifier <- NULL
test$Census_OEMNameIdentifier <- NULL

##############################################################################################



train$Census_OEMModelIdentifier <- NULL
test$Census_OEMModelIdentifier <- NULL
##############################################################################################



train$Census_ProcessorCoreCount <- NULL
test$Census_ProcessorCoreCount <- NULL

##############################################################################################



train$Census_ProcessorManufacturerIdentifier <- NULL
test$Census_ProcessorManufacturerIdentifier <- NULL



##############################################################################################


train$Census_ProcessorModelIdentifier <- NULL
test$Census_ProcessorModelIdentifier <- NULL

##############################################################################################



train$Census_ProcessorClass <- NULL
test$Census_ProcessorClass <- NULL

##############################################################################################

table(train$Census_PrimaryDiskTotalCapacity)
sum(is.na(train$Census_PrimaryDiskTotalCapacity))

train = merge(x = train, y = IV$Tables$Census_PrimaryDiskTotalCapacity[ , c("Census_PrimaryDiskTotalCapacity", "WOE")],
              by = "Census_PrimaryDiskTotalCapacity", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_PrimaryDiskTotalCapacityWOE'
sum(is.na(train$Census_PrimaryDiskTotalCapacityWOE))


test = merge(x = test, y = IV$Tables$Census_PrimaryDiskTotalCapacity[ , c("Census_PrimaryDiskTotalCapacity", "WOE")],
              by = "Census_PrimaryDiskTotalCapacity", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_PrimaryDiskTotalCapacityWOE'
sum(is.na(test$Census_PrimaryDiskTotalCapacityWOE))

test$Census_PrimaryDiskTotalCapacityWOE <- ifelse(is.na(test$Census_PrimaryDiskTotalCapacityWOE) == TRUE, 0,test$Census_PrimaryDiskTotalCapacityWOE)



train$Census_PrimaryDiskTotalCapacity <- NULL
test$Census_PrimaryDiskTotalCapacity <- NULL

##############################################################################################
table(train$Census_PrimaryDiskTypeName)
sum(is.na(train$Census_PrimaryDiskTypeName))

train = merge(x = train, y = IV$Tables$Census_PrimaryDiskTypeName[ , c("Census_PrimaryDiskTypeName", "WOE")],
              by = "Census_PrimaryDiskTypeName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_PrimaryDiskTypeNameWOE'
sum(is.na(train$Census_PrimaryDiskTypeNameWOE))



test = merge(x = test, y = IV$Tables$Census_PrimaryDiskTypeName[ , c("Census_PrimaryDiskTypeName", "WOE")],
              by = "Census_PrimaryDiskTypeName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_PrimaryDiskTypeNameWOE'
sum(is.na(test$Census_PrimaryDiskTypeNameWOE))


train$Census_PrimaryDiskTypeName <- NULL
test$Census_PrimaryDiskTypeName <- NULL

##############################################################################################

train$Census_SystemVolumeTotalCapacity <- NULL
test$Census_SystemVolumeTotalCapacity <- NULL

##############################################################################################

train$Census_HasOpticalDiskDrive <- NULL
test$Census_HasOpticalDiskDrive <- NULL
##############################################################################################
table(train$Census_TotalPhysicalRAM)
sum(is.na(train$Census_TotalPhysicalRAM))

train = merge(x = train, y = IV$Tables$Census_TotalPhysicalRAM[ , c("Census_TotalPhysicalRAM", "WOE")],
              by = "Census_TotalPhysicalRAM", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_TotalPhysicalRAMWOE'
sum(is.na(train$Census_TotalPhysicalRAMWOE))




test = merge(x = test, y = IV$Tables$Census_TotalPhysicalRAM[ , c("Census_TotalPhysicalRAM", "WOE")],
              by = "Census_TotalPhysicalRAM", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_TotalPhysicalRAMWOE'
sum(is.na(test$Census_TotalPhysicalRAMWOE))


train$Census_TotalPhysicalRAM <- NULL
test$Census_TotalPhysicalRAM <- NULL

##############################################################################################
table(train$Census_ChassisTypeName)
sum(is.na(train$Census_ChassisTypeName))

train = merge(x = train, y = IV$Tables$Census_ChassisTypeName[ , c("Census_ChassisTypeName", "WOE")],
              by = "Census_ChassisTypeName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_ChassisTypeNameWOE'
sum(is.na(train$Census_ChassisTypeNameWOE))




test = merge(x = test, y = IV$Tables$Census_ChassisTypeName[ , c("Census_ChassisTypeName", "WOE")],
             by = "Census_ChassisTypeName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_ChassisTypeNameWOE'
sum(is.na(test$Census_ChassisTypeNameWOE))


train$Census_ChassisTypeName <- NULL
test$Census_ChassisTypeName <- NULL

##############################################################################################
table(train$Census_InternalPrimaryDiagonalDisplaySizeInInches)
sum(is.na(train$Census_InternalPrimaryDiagonalDisplaySizeInInches))

train = merge(x = train, y = IV$Tables$Census_InternalPrimaryDiagonalDisplaySizeInInches[ , c("Census_InternalPrimaryDiagonalDisplaySizeInInches", "WOE")],
              by = "Census_InternalPrimaryDiagonalDisplaySizeInInches", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_InternalPrimaryDiagonalDisplaySizeInInchesWOE'
sum(is.na(train$Census_InternalPrimaryDiagonalDisplaySizeInInchesWOE))




test = merge(x = test, y = IV$Tables$Census_InternalPrimaryDiagonalDisplaySizeInInches[ , c("Census_InternalPrimaryDiagonalDisplaySizeInInches", "WOE")],
              by = "Census_InternalPrimaryDiagonalDisplaySizeInInches", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_InternalPrimaryDiagonalDisplaySizeInInchesWOE'
sum(is.na(test$Census_InternalPrimaryDiagonalDisplaySizeInInchesWOE))


train$Census_InternalPrimaryDiagonalDisplaySizeInInches <- NULL
test$Census_InternalPrimaryDiagonalDisplaySizeInInches <- NULL

##############################################################################################


train$Census_InternalPrimaryDisplayResolutionHorizontal <- NULL
test$Census_InternalPrimaryDisplayResolutionHorizontal <- NULL
##############################################################################################


train$Census_InternalPrimaryDisplayResolutionVertical <- NULL
test$Census_InternalPrimaryDisplayResolutionVertical <- NULL

##############################################################################################

##############################################################################################
table(train$Census_PowerPlatformRoleName)
sum(is.na(train$Census_PowerPlatformRoleName))

train = merge(x = train, y = IV$Tables$Census_PowerPlatformRoleName[ , c("Census_PowerPlatformRoleName", "WOE")],
              by = "Census_PowerPlatformRoleName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_PowerPlatformRoleNameWOE'
sum(is.na(train$Census_PowerPlatformRoleNameWOE))




test = merge(x = test, y = IV$Tables$Census_PowerPlatformRoleName[ , c("Census_PowerPlatformRoleName", "WOE")],
              by = "Census_PowerPlatformRoleName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_PowerPlatformRoleNameWOE'
sum(is.na(test$Census_PowerPlatformRoleNameWOE))


train$Census_PowerPlatformRoleName <- NULL
test$Census_PowerPlatformRoleName <- NULL

##############################################################################################
table(train$Census_InternalBatteryType)
sum(is.na(train$Census_InternalBatteryType))

train = merge(x = train, y = IV$Tables$Census_InternalBatteryType[ , c("Census_InternalBatteryType", "WOE")],
              by = "Census_InternalBatteryType", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_InternalBatteryTypeWOE'
sum(is.na(train$Census_InternalBatteryTypeWOE))



test = merge(x = test, y = IV$Tables$Census_InternalBatteryType[ , c("Census_InternalBatteryType", "WOE")],
              by = "Census_InternalBatteryType", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_InternalBatteryTypeWOE'
sum(is.na(test$Census_InternalBatteryTypeWOE))



train$Census_InternalBatteryType <- NULL
test$Census_InternalBatteryType <- NULL


##############################################################################################




train$Census_InternalBatteryNumberOfCharges <- NULL
test$Census_InternalBatteryNumberOfCharges <- NULL

##############################################################################################



train$Census_OSVersion<- NULL
test$Census_OSVersion <- NULL

##############################################################################################
##############################################################################################



train$Census_OSArchitecture <- NULL
test$Census_OSArchitecture <- NULL

##############################################################################################
table(train$Census_OSBranch)
sum(is.na(train$Census_OSBranch))

train = merge(x = train, y = IV$Tables$Census_OSBranch[ , c("Census_OSBranch", "WOE")],
              by = "Census_OSBranch", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSBranchWOE'
sum(is.na(train$Census_OSBranchWOE))



test = merge(x = test, y = IV$Tables$Census_OSBranch[ , c("Census_OSBranch", "WOE")],
              by = "Census_OSBranch", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSBranchWOE'
sum(is.na(test$Census_OSBranchWOE))


train$Census_OSBranch <- NULL
test$Census_OSBranch <- NULL


##############################################################################################
table(train$Census_OSBuildNumber)
sum(is.na(train$Census_OSBuildNumber))

train = merge(x = train, y = IV$Tables$Census_OSBuildNumber[ , c("Census_OSBuildNumber", "WOE")],
              by = "Census_OSBuildNumber", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSBuildNumberWOE'
sum(is.na(train$Census_OSBuildNumberWOE))



test = merge(x = test, y = IV$Tables$Census_OSBuildNumber[ , c("Census_OSBuildNumber", "WOE")],
              by = "Census_OSBuildNumber", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSBuildNumberWOE'
sum(is.na(test$Census_OSBuildNumberWOE))

train$Census_OSBuildNumber <- NULL
test$Census_OSBuildNumber <- NULL


##############################################################################################
table(train$Census_OSBuildRevision)
sum(is.na(train$Census_OSBuildRevision))

train = merge(x = train, y = IV$Tables$Census_OSBuildRevision[ , c("Census_OSBuildRevision", "WOE")],
              by = "Census_OSBuildRevision", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSBuildRevisionWOE'
sum(is.na(train$Census_OSBuildRevisionWOE))



test = merge(x = test, y = IV$Tables$Census_OSBuildRevision[ , c("Census_OSBuildRevision", "WOE")],
              by = "Census_OSBuildRevision", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSBuildRevisionWOE'
sum(is.na(test$Census_OSBuildRevisionWOE))

train$Census_OSBuildRevision <- NULL
test$Census_OSBuildRevision <- NULL


##############################################################################################
table(train$Census_OSEdition)
sum(is.na(train$Census_OSEdition))
length(unique(train$Census_OSEdition))

train = merge(x = train, y = IV$Tables$Census_OSEdition[ , c("Census_OSEdition", "WOE")],
              by = "Census_OSEdition", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSEditionWOE'
sum(is.na(train$Census_OSBuildRevisionWOE))



test = merge(x = test, y = IV$Tables$Census_OSEdition[ , c("Census_OSEdition", "WOE")],
              by = "Census_OSEdition", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSEditionWOE'
sum(is.na(test$Census_OSBuildRevisionWOE))


train$Census_OSEdition <- NULL
test$Census_OSEdition <- NULL

##############################################################################################
table(train$Census_OSSkuName)
sum(is.na(train$Census_OSSkuName))
length(unique(train$Census_OSSkuName))

train = merge(x = train, y = IV$Tables$Census_OSSkuName[ , c("Census_OSSkuName", "WOE")],
              by = "Census_OSSkuName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSSkuNameWOE'
sum(is.na(train$Census_OSSkuNameWOE))



test = merge(x = test, y = IV$Tables$Census_OSSkuName[ , c("Census_OSSkuName", "WOE")],
              by = "Census_OSSkuName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSSkuNameWOE'
sum(is.na(test$Census_OSSkuNameWOE))


train$Census_OSSkuName <- NULL
test$Census_OSSkuName <- NULL

##############################################################################################
table(test$Census_OSInstallTypeName)
sum(is.na(train$Census_OSInstallTypeName))
length(unique(train$Census_OSInstallTypeName))

train = merge(x = train, y = IV$Tables$Census_OSInstallTypeName[ , c("Census_OSInstallTypeName", "WOE")],
              by = "Census_OSInstallTypeName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSInstallTypeNameWOE'
sum(is.na(train$Census_OSInstallTypeName))


test = merge(x = test, y = IV$Tables$Census_OSInstallTypeName[ , c("Census_OSInstallTypeName", "WOE")],
              by = "Census_OSInstallTypeName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSInstallTypeNameWOE'
sum(is.na(test$Census_OSInstallTypeNameWOE))



train$Census_OSInstallTypeName <- NULL
test$Census_OSInstallTypeName <- NULL

colnames(test)




# Census_OSUILocaleIdentifier

table(train$Census_OSUILocaleIdentifier)
sum(is.na(train$Census_OSUILocaleIdentifier))

train = merge(x = train, y = IV$Tables$Census_OSUILocaleIdentifier[ , c("Census_OSUILocaleIdentifier", "WOE")], by = "Census_OSUILocaleIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSUILocaleIdentifierWOE'
sum(is.na(train$Census_OSUILocaleIdentifierWOE))
unique(train$Census_OSUILocaleIdentifierWOE)

test = merge(x = test, y = IV$Tables$Census_OSUILocaleIdentifier[ , c("Census_OSUILocaleIdentifier", "WOE")], by = "Census_OSUILocaleIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSUILocaleIdentifierWOE'
sum(is.na(test$Census_OSUILocaleIdentifierWOE))

train$Census_OSUILocaleIdentifier <- NULL 
test$Census_OSUILocaleIdentifier <- NULL


# Census_OSInstallLanguageIdentifier

table(train$Census_OSInstallLanguageIdentifier)
sum(is.na(train$Census_OSInstallLanguageIdentifier))

train = merge(x = train, y = IV$Tables$Census_OSInstallLanguageIdentifier[ , c("Census_OSInstallLanguageIdentifier", "WOE")], by = "Census_OSInstallLanguageIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSInstallLanguageIdentifierWOE'
sum(is.na(train$Census_OSInstallLanguageIdentifierWOE))
unique(train$Census_OSInstallLanguageIdentifierWOE)

test = merge(x = test, y = IV$Tables$Census_OSInstallLanguageIdentifier[ , c("Census_OSInstallLanguageIdentifier", "WOE")], by = "Census_OSInstallLanguageIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSUILocaleIdentifierWOE'
sum(is.na(test$Census_OSInstallLanguageIdentifierWOE))

train$Census_OSInstallLanguageIdentifier <- NULL 
test$Census_OSInstallLanguageIdentifier <- NULL


colnames(test)
# Wdft_RegionIdentifier

table(train$Wdft_RegionIdentifier)
sum(is.na(train$Wdft_RegionIdentifier))
train = merge(x = train, y = IV$Tables$Wdft_RegionIdentifier[ , c("Wdft_RegionIdentifier", "WOE")], by = "Wdft_RegionIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Wdft_RegionIdentifierWOE'
sum(is.na(train$ProductNameWOE))
unique(train$Wdft_RegionIdentifierWOE)

test = merge(x = test, y = IV$Tables$Wdft_RegionIdentifier[ , c("Wdft_RegionIdentifier", "WOE")], by = "Wdft_RegionIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Wdft_RegionIdentifierWOE'
sum(is.na(test$Wdft_RegionIdentifierWOE))

train$Wdft_RegionIdentifier <- NULL 
test$Wdft_RegionIdentifier <- NULL


# Wdft_IsGamer

table(train$Wdft_IsGamer)
sum(is.na(train$Wdft_IsGamer))
train = merge(x = train, y = IV$Tables$Wdft_IsGamer[ , c("Wdft_IsGamer", "WOE")], by = "Wdft_IsGamer", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Wdft_IsGamerWOE'
sum(is.na(train$Wdft_IsGamerWOE))
unique(train$Wdft_IsGamerWOE)

test = merge(x = test, y = IV$Tables$Wdft_IsGamer[ , c("Wdft_IsGamer", "WOE")], by = "Wdft_IsGamer", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Wdft_IsGamerWOE'
sum(is.na(test$Wdft_IsGamerWOE))

train$Wdft_IsGamer <- NULL 
test$Wdft_IsGamer <- NULL




# Census_IsAlwaysOnAlwaysConnectedCapable

table(train$Census_IsAlwaysOnAlwaysConnectedCapable)
sum(is.na(train$Wdft_IsGamer))
train = merge(x = train, y = IV$Tables$Census_IsAlwaysOnAlwaysConnectedCapable[ , c("Census_IsAlwaysOnAlwaysConnectedCapable", "WOE")], by = "Census_IsAlwaysOnAlwaysConnectedCapable", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_IsAlwaysOnAlwaysConnectedCapableWOE'
sum(is.na(train$Census_IsAlwaysOnAlwaysConnectedCapableWOE))
unique(train$Census_IsAlwaysOnAlwaysConnectedCapableWOE)

test = merge(x = test, y = IV$Tables$Census_IsAlwaysOnAlwaysConnectedCapable[ , c("Census_IsAlwaysOnAlwaysConnectedCapable", "WOE")], by = "Census_IsAlwaysOnAlwaysConnectedCapable", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_IsAlwaysOnAlwaysConnectedCapableWOE'
sum(is.na(test$Census_IsAlwaysOnAlwaysConnectedCapableWOE))

train$Census_IsAlwaysOnAlwaysConnectedCapable <- NULL 
test$Census_IsAlwaysOnAlwaysConnectedCapable <- NULL


# Census_IsPenCapable

table(train$Census_IsPenCapable)
sum(is.na(train$Census_IsPenCapable))
train = merge(x = train, y = IV$Tables$Census_IsPenCapable[ , c("Census_IsPenCapable", "WOE")], by = "Census_IsPenCapable", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_IsPenCapableWOE'
sum(is.na(train$Census_IsPenCapableWOE))
unique(train$Census_IsPenCapableWOE)

test = merge(x = test, y = IV$Tables$Census_IsPenCapable[ , c("Census_IsPenCapable", "WOE")], by = "Census_IsPenCapable", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_IsPenCapableWOE'
sum(is.na(test$Census_IsPenCapableWOE))

train$Census_IsPenCapable <- NULL 
test$Census_IsPenCapable <- NULL



# Census_IsTouchEnabled

table(train$Census_IsTouchEnabled)
sum(is.na(train$Census_IsTouchEnabled))
train = merge(x = train, y = IV$Tables$Census_IsTouchEnabled[ , c("Census_IsTouchEnabled", "WOE")], by = "Census_IsTouchEnabled", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_Census_IsTouchEnabledWOE'
names(train)[names(train) == 'Census_Census_IsTouchEnabledWOE'] <- 'Census_IsTouchEnabledWOE'
sum(is.na(train$Census_IsTouchEnabledWOE))
unique(train$Census_IsTouchEnabledWOE)

test = merge(x = test, y = IV$Tables$Census_IsTouchEnabled[ , c("Census_IsTouchEnabled", "WOE")], by = "Census_IsTouchEnabled", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_IsTouchEnabledWOE'
sum(is.na(test$Census_IsTouchEnabledWOE))

train$Census_IsTouchEnabled <- NULL 
test$Census_IsTouchEnabled <- NULL




# Census_IsVirtualDevice

table(train$Census_IsVirtualDevice)
sum(is.na(train$Census_IsVirtualDevice))

train$Census_IsVirtualDevice <- NULL

test$Census_IsVirtualDevice <- NULL



# Census_IsWIMBootEnabled

table(train$Census_IsWIMBootEnabled)
sum(is.na(train$Census_IsWIMBootEnabled))

train$Census_IsWIMBootEnabled<- NULL 
test$Census_IsWIMBootEnabled<- NULL 

# Census_IsSecureBootEnabled

table(train$Census_IsSecureBootEnabled)
sum(is.na(train$Census_IsSecureBootEnabled))
train = merge(x = train, y = IV$Tables$Census_IsSecureBootEnabled[ , c("Census_IsSecureBootEnabled", "WOE")], by = "Census_IsSecureBootEnabled", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_IsSecureBootEnabledWOE'
sum(is.na(train$Census_IsSecureBootEnabledWOE))
unique(train$Census_IsSecureBootEnabledWOE)

test = merge(x = test, y = IV$Tables$Census_IsSecureBootEnabled[ , c("Census_IsSecureBootEnabled", "WOE")], by = "Census_IsSecureBootEnabled", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_IsSecureBootEnabledWOE'
sum(is.na(test$Census_IsSecureBootEnabledWOE))

train$Census_IsSecureBootEnabled <- NULL 
test$Census_IsSecureBootEnabled <- NULL



# Census_FirmwareVersionIdentifier

table(train$Census_FirmwareVersionIdentifier)
sum(is.na(train$Census_FirmwareVersionIdentifier))

train$Census_FirmwareVersionIdentifier <- NULL
test$Census_FirmwareVersionIdentifier <- NULL


# Census_FirmwareManufacturerIdentifier

table(train$Census_FirmwareManufacturerIdentifier)
sum(is.na(train$Census_FirmwareManufacturerIdentifier))
train = merge(x = train, y = IV$Tables$Census_FirmwareManufacturerIdentifier[ , c("Census_FirmwareManufacturerIdentifier", "WOE")], by = "Census_FirmwareManufacturerIdentifier", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_FirmwareManufacturerIdentifierWOE'
sum(is.na(train$Census_FirmwareManufacturerIdentifierWOE))
unique(train$Census_FirmwareManufacturerIdentifierWOE)

test = merge(x = test, y = IV$Tables$Census_FirmwareManufacturerIdentifier[ , c("Census_FirmwareManufacturerIdentifier", "WOE")], by = "Census_FirmwareManufacturerIdentifier", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_FirmwareManufacturerIdentifierWOE'
sum(is.na(test$Census_FirmwareManufacturerIdentifierWOE))

train$Census_FirmwareManufacturerIdentifier <- NULL 
test$Census_FirmwareManufacturerIdentifier <- NULL



# Census_ThresholdOptIn

table(train$Census_ThresholdOptIn)
sum(is.na(train$Census_FirmwareManufacturerIdentifier))

train$Census_ThresholdOptIn <- NULL
test$Census_ThresholdOptIn <- NULL

# Census_FlightRing

table(train$Census_FlightRing)
sum(is.na(train$Census_FlightRing))
train = merge(x = train, y = IV$Tables$Census_FlightRing[ , c("Census_FlightRing", "WOE")], by = "Census_FlightRing", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_FlightRingWOE'
sum(is.na(train$Census_FlightRingWOE))
unique(train$Census_FlightRingWOE)

test = merge(x = test, y = IV$Tables$Census_FlightRing[ , c("Census_FlightRing", "WOE")], by = "Census_FlightRing", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_FlightRingWOE'
sum(is.na(test$Census_FlightRingWOE))

train$Census_FlightRing <- NULL 
test$Census_FlightRing <- NULL


# Census_IsFlightsDisabled

table(train$Census_IsFlightsDisabled)
sum(is.na(train$Census_IsFlightsDisabled))

train$Census_IsFlightsDisabled <- NULL
test$Census_IsFlightsDisabled <- NULL




# Census_IsFlightingInternal



table(train$Census_IsFlightingInternal)
sum(is.na(train$Census_IsFlightingInternal))

train$Census_IsFlightingInternal <- NULL
test$Census_IsFlightingInternal <- NULL


# Census_ActivationChannel

table(train$Census_ActivationChannel)
sum(is.na(train$Census_ActivationChannel))
train = merge(x = train, y = IV$Tables$Census_ActivationChannel[ , c("Census_ActivationChannel", "WOE")], by = "Census_ActivationChannel", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_ActivationChannelWOE'
sum(is.na(train$Census_ActivationChannelWOE))
unique(train$Census_ActivationChannelWOE)

test = merge(x = test, y = IV$Tables$Census_ActivationChannel[ , c("Census_ActivationChannel", "WOE")], by = "Census_ActivationChannel", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_ActivationChannelWOE'
sum(is.na(test$Census_ActivationChannelWOE))

train$Census_ActivationChannel <- NULL 
test$Census_ActivationChannel <- NULL



# Census_GenuineStateName


table(train$Census_GenuineStateName)
sum(is.na(train$Census_GenuineStateName))
train = merge(x = train, y = IV$Tables$Census_GenuineStateName[ , c("Census_GenuineStateName", "WOE")], by = "Census_GenuineStateName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_GenuineStateNameWOE'
sum(is.na(train$Census_GenuineStateNameWOE))
unique(train$Census_GenuineStateNameWOE)

test = merge(x = test, y = IV$Tables$Census_GenuineStateName[ , c("Census_GenuineStateName", "WOE")], by = "Census_GenuineStateName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_GenuineStateNameWOE'
sum(is.na(test$Census_GenuineStateNameWOE))

train$Census_GenuineStateName <- NULL 
test$Census_GenuineStateName <- NULL



# Census_IsPortableOperatingSystem

table(train$Census_IsPortableOperatingSystem)
sum(is.na(train$Census_GenuineStateName))

train$Census_IsPortableOperatingSystem <- NULL
test$Census_IsPortableOperatingSystem <- NULL

#Census_OSWUAutoUpdateOptionsName

table(train$Census_OSWUAutoUpdateOptionsName)
sum(is.na(train$Census_GenuineStateName))

train = merge(x = train, y = IV$Tables$Census_OSWUAutoUpdateOptionsName[ , c("Census_OSWUAutoUpdateOptionsName", "WOE")], by = "Census_OSWUAutoUpdateOptionsName", all.x=TRUE)
names(train)[names(train) == 'WOE'] <- 'Census_OSWUAutoUpdateOptionsNameWOE'
sum(is.na(train$Census_OSWUAutoUpdateOptionsNameWOE))
unique(train$Census_OSWUAutoUpdateOptionsNameWOE)

test = merge(x = test, y = IV$Tables$Census_OSWUAutoUpdateOptionsName[ , c("Census_OSWUAutoUpdateOptionsName", "WOE")], by = "Census_OSWUAutoUpdateOptionsName", all.x=TRUE)
names(test)[names(test) == 'WOE'] <- 'Census_OSWUAutoUpdateOptionsNameWOE'
sum(is.na(test$Census_OSWUAutoUpdateOptionsNameWOE))

train$Census_OSWUAutoUpdateOptionsName <- NULL 
test$Census_OSWUAutoUpdateOptionsName <- NULL


write.csv(train, file = "final_train.csv")
write.csv(test, file = "final_test.csv")
